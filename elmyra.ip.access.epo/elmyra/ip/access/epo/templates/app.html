## -*- coding: utf-8 -*-
## (c) 2013-2015 Andreas Motl, Elmyra UG

<%inherit file="site.mako" />

<%block name="body">

## http://bootsnipp.com/snipps/e-mail-interface-like-gmail
## http://davidsulc.com/blog/2012/04/15/a-simple-backbone-marionette-tutorial/
## https://github.com/davidsulc/backbone.marionette-collection-example

% if request.registry.settings.get('ipsuite.production') == 'true':
<script type="text/javascript" src="/static/js/config.min.js"></script>
% else:
<script type="text/javascript" src="/static/js/config.js"></script>
% endif

<%
# FIXME: this is the last thing we have to keep until this bunch of html got refactored into a template
debugmode = h.asbool(request.params.get('debug'))
%>

<script type="application/javascript">
${ h.fiddler.render() | n }
</script>


## title / headline
<div class="container-fluid header-container">
    <div class="span8">
        <h3 id="ui-title" style="display: inline-block"></h3>
        <span id="ui-subtitle"></span>
        <div id="ui-statusline"></div>
    </div>
    <div class="span4">
        <div class="pull-right">
            <div class="btn-group do-not-print">
                <a href="/logout"
                   role="button" class="btn btn-popover"
                   data-toggle="popover" data-trigger="hover" data-placement="bottom"
                   data-content="Sign out"
                   >
                    <i class="icon-signout"></i>
                </a>
                <a target="_blank"
                   role="button" class="btn btn-popover link-help"
                   data-toggle="popover" data-trigger="hover" data-placement="bottom"
                   data-content="Online help"
                   >
                    <i class="icon-question-sign"></i>
                </a>
                <a target="_blank"
                   role="button" class="btn btn-popover link-fullscreen"
                   data-toggle="popover" data-trigger="hover" data-placement="bottom"
                   data-content="Fullscreen"
                        >
                    <i class="icon-fullscreen"></i>
                </a>
            </div>
            &nbsp;&nbsp;&nbsp;
            <h3 id="ui-productname" style="display: inline-block"></h3>
        </div>
    </div>
</div>

<br/>

<div class="container-fluid span12">

    ## query builder and basket
    <div class="row-fluid do-not-print non-liveview" id="querybuilder-basket-area">

        <div class="span8" id="querybuilder-region">&nbsp;</div>

        <!-- database actions -->
        <div class="span4">
            <div class="row-fluid">
                <div class="span12">
                    <!-- project chooser -->
                    <div id="project-chooser-area"></div>
                </div>

            </div>

            <div class="row-fluid">
                % if ship_mode != 'single-bibdata':
                <div class="span12" id="basket-region"></div>
                % endif
            </div>

        </div>

    </div>


    ## pager top
    <div class="pager-area do-not-print" id="ops-pagination-region-top"></div>

    <div id="modal-area"></div>

    ## metadata
    <div id="ops-metadata-region"></div>

    ## notifications and alerts
    <div id="alert-area"></div>
    <div id="info-area"></div>

    ## results
    <div id="ops-collection-region"></div>

    ## pager bottom
    <div class="pager-area do-not-print" id="ops-pagination-region-bottom"></div>

    <hr class="clear-margin" style="margin-top: 50px"/>
    <div class="page-footer pull-left">
        &copy; 2013-2016, Elmyra UG — All rights reserved.
    </div>
    <div class="page-footer pull-right">
        <small>
            <div style="text-align: right">
                <span id="ui-footer"></span>
                <span id="ui-footer-version"></span>
                <span class="do-not-print">
                    Help: <a target="_blank" class="incognito pointer link-help"><i class="icon-question-sign icon-large"></i></a>
                </span>
            </div>
        </small>
    </div>

</div>


## ------------------------------------------
##   generic collection template
## ------------------------------------------
<script id="generic-collection-template" type="text/x-underscore-template">
</script>


<!-- modal dialog for viewing online help -->
<div id="help-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="help-modal-label" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="help-modal-label">Online help</h3>
    </div>
    <div class="modal-body" id="help-body">
        <a href="https://en.wikipedia.org/wiki/Contextual_Query_Language" target="_blank">About CQL</a>
    </div>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
</div>


<!-- modal dialog for choosing clipboard content modifier -->
<div id="clipboard-modifier-chooser" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="clipboard-modifier-chooser-label" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="clipboard-modifier-chooser-label">Query transformation</h3>
    </div>
    <div class="modal-body">
        Transform newline-separated data to syntactically correct query.
        <br/><br/>
        <div class="btn-group btn-group-vertical">
            <button class="btn btn-large btn-success btn-clipboard-modifier" data-modifier="num">
                <strong>Number: Publication-, application- or priority number</strong>
                <br/><br/>
                <small>e.g. "num=DE102012220639A1 OR num=EP0666666A2 OR num=..."</small>
            </button>
            <button class="btn btn-large btn-warning btn-clipboard-modifier" data-modifier="txt">
                <strong>Text: Title, abstract, inventor-, or applicant name</strong>
                <br/><br/>
                <small>e.g. "txt=siemens OR txt=alstom OR txt=..."</small>
            </button>
            <button class="btn btn-large btn-danger btn-clipboard-modifier" data-modifier="cl">
                <strong>Class: CPC or IPC8 class</strong>
                <br/><br/>
                <small>e.g. "cl=H04L12/24 OR cl=H04L12/26 OR cl=..."</small>
            </button>
        </div>
    </div>
    <div class="modal-footer">
        <div id="clipboard-modifier-operator" class="btn-group pull-left" data-toggle="buttons-radio">
            <button class="btn active" type="button" data-value="OR">OR</button>
            <button class="btn"        type="button" data-value="AND">AND</button>
        </div>
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
</div>


<script id="backend-error-template" type="text/x-underscore-template">

    <div class="alert alert-error alert-block alert-inline">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <h4>ERROR</h4>
        <%text>

        <dl class="dl-horizontal dl-horizontal-biblio2">

            <dt>
                Description
            </dt>
            <dd>
                <h4><%= description['content'] || '&nbsp;' %></h4>
            </dd>

            <br/>

            <dt>
                Date
            </dt>
            <dd>
                <%= description['headers']['date'] || '&nbsp;' %>
            </dd>

            <dt>
                Status
            </dt>
            <dd>
                <%= description['status_code'] || '&nbsp;' %> <%= description['reason'] || '&nbsp;' %>
            </dd>

            <dt>
                Location
            </dt>
            <dd>
                <%= location || '&nbsp;' %>
            </dd>

            <dt>
                Name
            </dt>
            <dd>
                <%= name || '&nbsp;' %>
            </dd>

            <dt>
                URL
            </dt>
            <dd>
                <%= description['url'] || '&nbsp;' %>
            </dd>

        </dl>
        </%text>

    </div>

</script>


<script id="cornice-error-template" type="text/x-underscore-template">

    <div class="alert alert-error alert-block alert-inline">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <h4>ERROR</h4>
        <%text>

        <dl class="dl-horizontal dl-horizontal-biblio2">

            <dt>
                Description
            </dt>
            <dd>
                <h4><%= description %></h4>
            </dd>

            <br/>

            <dt>
                Location
            </dt>
            <dd>
                <%= location %>
            </dd>

            <dt>
                Name
            </dt>
            <dd>
                <%= name %>
            </dd>

            <% if (details) { %>
            <dt>
                Details
            </dt>
            <dd>
                <%= details %>
            </dd>
            <% } %>

        </dl>
        </%text>

    </div>

</script>


<script id="alert-template" type="text/x-underscore-template">
    <%text>
    <div class="alert alert-block alert-inline <%= clazz %> user-alert">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <h4><%= title %></h4>
        <br/>
        <%= description %>
    </div>
    </%text>
</script>

<!-- user interface: templates -->
<%include file="querybuilder.html"/>
<%include file="basket.html"/>
<%include file="project.html"/>
<%include file="result/list.html"/>
<%include file="result/pagination.html"/>
<%include file="comment.html"/>
<%include file="ops.html"/>
<%include file="ops/util.html"/>
<%include file="ftpro.html"/>
<%include file="permalink.html"/>
<%include file="keyword-editor.html"/>

<!-- common -->
<script type="text/javascript" src="/static/js/lib/es6-shim.min.js"></script>
<script type="text/javascript" src="/static/js/lib/Blob.js"></script>
<script type="text/javascript" src="/static/js/lib/FileSaver.js"></script>
<script type="text/javascript" src="/static/js/lib/dataurl.js"></script>
<script type="text/javascript" src="/static/js/lib/lz-string-1.3.3-min.js"></script>
<script type="text/javascript" src="/static/js/lib/memoize.js"></script>
<script type="text/javascript" src="/static/js/lib/humanize.min.js"></script>

<!-- storage -->
<script type="text/javascript" src="/static/js/lib/backbone-relational.js"></script>

## <!-- TODO: minify again, but currently includes important patches -->
## <!-- <script type="text/javascript" src="/static/js/lib/localforage.min.js"></script> -->
<script type="text/javascript" src="/static/js/lib/localforage.js"></script>

## <!-- TODO: minify again, but currently includes important patches -->
## <!-- <script type="text/javascript" src="/static/js/lib/localforage.backbone-0.4.0.min.js"></script> -->
<script type="text/javascript" src="/static/js/lib/localforage.backbone.js"></script>


<!-- user interface: libraries -->
<script type="text/javascript" src="/static/js/lib/backbone-dom-to-view.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.caret-1.5.1.min.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.hotkeys.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.highlight.bartaz.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery-autonumeric.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.viewport.min.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.base64.min.js"></script>
<script type="text/javascript" src="/static/js/lib/bootbox-2.3.2.min.js"></script>
<script type="text/javascript" src="/static/js/lib/moment-with-langs.min.js"></script>
<script type="text/javascript" src="/static/js/lib/bootstrap-tab-button.js"></script>
<script type="text/javascript" src="/static/js/lib/notify-combined.min.js"></script>
<script type="text/javascript" src="/static/js/lib/ZeroClipboard.min.js"></script>
<script type="text/javascript" src="/static/js/lib/screenfull.min.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.waypoints.min.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.waypoints.sticky.min.js"></script>
<script type="text/javascript" src="/static/js/lib/jquery.waypoints.inview.min.js"></script>
<script type="text/javascript" src="/static/js/lib/ToProgress.min.js"></script>

<!-- user interface: widgets -->
<script type="text/javascript" src="/static/widget/bootstrap-editable/js/bootstrap-editable.min.js"></script>
<link rel="stylesheet" type="text/css" href="/static/widget/bootstrap-editable/css/bootstrap-editable.css" />
<script type="text/javascript" src="/static/widget/raty/jquery.raty.js"></script>

<!-- notificator widget -->
<script type="text/javascript" src="/static/widget/notificator/js/modernizr.custom.js"></script>
<script type="text/javascript" src="/static/widget/notificator/js/classie.js"></script>
<script type="text/javascript" src="/static/widget/notificator/js/notificationFx.js"></script>
<link rel="stylesheet" type="text/css" href="/static/widget/notificator/css/ns-default.css" />
<link rel="stylesheet" type="text/css" href="/static/widget/notificator/css/ns-style-attached.css" />

<!-- pagination widget -->
<script type="text/javascript" src="/static/widget/jqpagination/js/jquery.jqpagination.min.js"></script>
<link rel="stylesheet" type="text/css" href="/static/widget/jqpagination/css/jqpagination.css" />


<!-- application -->
<link rel="stylesheet" type="text/css" href="/static/css/app.css" />

<!-- application -->
% if request.registry.settings.get('ipsuite.production') != 'true':
    <script type="text/javascript" src="/static/js/ipsuite/linkmaker.js"></script>
    <script type="text/javascript" src="/static/js/app/util.js"></script>
    <script type="text/javascript" src="/static/js/app/patents.js"></script>
    <script type="text/javascript" src="/static/js/app/core.js"></script>
    <script type="text/javascript" src="/static/js/app/ops-sdk.js"></script>
    <script type="text/javascript" src="/static/js/app/models/01-results.js"></script>
    <script type="text/javascript" src="/static/js/app/models/01-search.js"></script>
    <script type="text/javascript" src="/static/js/app/models/10-ops-base.js"></script>
    <script type="text/javascript" src="/static/js/app/models/ops.js"></script>
    <script type="text/javascript" src="/static/js/app/models/generic.js"></script>
    <script type="text/javascript" src="/static/js/app/models/depatisnet.js"></script>
    <script type="text/javascript" src="/static/js/app/models/google.js"></script>
    <script type="text/javascript" src="/static/js/app/models/ftpro.js"></script>
    <script type="text/javascript" src="/static/js/app/models/ifi.js"></script>
    <script type="text/javascript" src="/static/js/app/views/01-results.js"></script>
    <script type="text/javascript" src="/static/js/app/views/pagination.js"></script>
    <script type="text/javascript" src="/static/js/app/views/ops.js"></script>
    <script type="text/javascript" src="/static/js/app/views/ftpro.js"></script>
    <script type="text/javascript" src="/static/js/app/application.js"></script>
    <script type="text/javascript" src="/static/js/app/ui.js"></script>
    <script type="text/javascript" src="/static/js/components/document.js"></script>
    <script type="text/javascript" src="/static/js/components/keywords.js"></script>
    <script type="text/javascript" src="/static/js/components/opaquelinks.js"></script>
    <script type="text/javascript" src="/static/js/components/querybuilder.js"></script>
    <script type="text/javascript" src="/static/js/components/basket.js"></script>
    <script type="text/javascript" src="/static/js/components/project.js"></script>
    <script type="text/javascript" src="/static/js/components/comment.js"></script>
    <script type="text/javascript" src="/static/js/components/storage.js"></script>
    <script type="text/javascript" src="/static/js/components/permalink.js"></script>
    <script type="text/javascript" src="/static/js/components/hotkeys.js"></script>
    <script type="text/javascript" src="/static/js/components/viewport.js"></script>
    <script type="text/javascript" src="/static/js/components/export.js"></script>
    <script type="text/javascript" src="/static/js/components/analytics.js"></script>
    <script type="text/javascript" src="/static/js/components/waypoints.js"></script>
    <script type="text/javascript" src="/static/js/components/reading.js"></script>
% endif

</%block>
